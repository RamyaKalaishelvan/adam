<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="">
  <meta name="author" content="Mark Otto, Jacob Thornton, and Bootstrap contributors">
  <meta name="generator" content="Hugo 0.84.0">
  <title> ADAMS </title>

  <link rel="canonical" href="https://getbootstrap.com/docs/5.0/examples/blog/">



  <!-- Bootstrap core CSS -->
  <link href="assets/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="css/custom.css" rel="stylesheet">

  <!-- Custom styles for this template -->
  <link href="https://fonts.googleapis.com/css?family=Playfair&#43;Display:700,900&amp;display=swap" rel="stylesheet">
  <!-- Custom styles for this template -->
  <link href="blog.css" rel="stylesheet">

  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
  <!-- <script src='https://api.mapbox.com/mapbox.js/v3.2.1/mapbox.js'></script>
  <link href='https://api.mapbox.com/mapbox.js/v3.2.1/mapbox.css' rel='stylesheet' /> -->
  <link href="https://api.mapbox.com/mapbox-gl-js/v2.7.0/mapbox-gl.css" rel="stylesheet">
  <link href="https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-draw/v1.2.2/mapbox-gl-draw.css" rel="stylesheet">
  <script src="https://api.mapbox.com/mapbox-gl-js/v2.7.0/mapbox-gl.js"></script>
  <script src="https://unpkg.com/@turf/turf@6/turf.min.js"></script>
  <script src="https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-draw/v1.2.2/mapbox-gl-draw.js"></script>
  <!-- Load the `mapbox-gl-geocoder` plugin. -->
  <script
    src="https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-geocoder/v4.7.2/mapbox-gl-geocoder.min.js"></script>
  <link rel="stylesheet"
    href="https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-geocoder/v4.7.2/mapbox-gl-geocoder.css" type="text/css">
</head>

<body>

  <div class="container">
    <header class="blog-header py-3">
      <div class="row flex-nowrap justify-content-between align-items-center">
        <div class="col-4 pt-1">

        </div>
        <div class="col-4 text-center">
          <a class="blog-header-logo text-dark text-decoration-none" href="#"> ADAMS </a>
        </div>
        <div class="col-4 d-flex justify-content-end align-items-center">

        </div>
      </div>
    </header>


  </div>

  <main class="container">
    <div class="row g-5">
      <div class="col-md-4">
        <article class="blog-post">
          <table class="table table-hover">
            <tbody id="map_details" style="">
			
              <!-- <tr> -->
                <!-- <td> -->
                  <!-- <i class="fa fa-map-marker fa-2x red"> </i> -->
                <!-- </td> -->
                <!-- <td> -->
                  <!-- <a href="#" class="map-btn button" data-latLng="77.580643,12.972442"> -->
                    <!-- <address class="mb-0"> -->
                      <!-- <strong> Bengaluru </strong><br> -->
                      <!-- Karnataka <br> -->
                      <!-- India <br> -->
                      <!-- P: (123) 456-7890 -->
                    <!-- </address> -->
                  <!-- </a> -->
                <!-- </td> -->
              <!-- </tr> -->
              <!-- <tr> -->
                <!-- <td> <i class="fa fa-map-marker fa-2x green"> </i> </td> -->
                <!-- <td> <a href="#" class="map-btn button" data-latLng="76.652985,12.311827"> -->
                    <!-- <address class="mb-0"> -->
                      <!-- <strong> Mysuru </strong><br> -->
                      <!-- Karnataka <br> -->
                      <!-- India <br> -->
                      <!-- P: (123) 456-7890 -->
                    <!-- </address> -->
                  <!-- </a> </td> -->
              <!-- </tr> -->
              <!-- <tr> -->
                <!-- <td> <i class="fa fa-map-marker fa-2x red"> </i> </td> -->
                <!-- <td> <a href="#" class="map-btn button" data-latLng="72.877426,19.076090"> -->
                    <!-- <address class="mb-0"> -->
                      <!-- <strong> Mumbai </strong><br> -->
                      <!-- Maharashtra <br> -->
                      <!-- India <br> -->
                      <!-- P: (123) 456-7890 -->
                    <!-- </address> -->
                  <!-- </a> </td> -->
              <!-- </tr> -->
              <!-- <tr> -->
                <!-- <td> <i class="fa fa-map-marker fa-2x green"> </i> </td> -->
                <!-- <td> <a href="#" class="map-btn button" data-latLng="73.856255,18.516726"> -->
                    <!-- <address class="mb-0"> -->
                      <!-- <strong> Pune </strong><br> -->
                      <!-- Maharashtra <br> -->
                      <!-- India <br> -->
                      <!-- P: (123) 456-7890 -->
                    <!-- </address> -->
                  <!-- </a> </td> -->
              <!-- </tr> -->
              <!-- <tr> -->
                <!-- <td> <i class="fa fa-map-marker fa-2x green"> </i> </td> -->
                <!-- <td> <a href="#" class="map-btn button" data-latLng="77.216721,28.644800"> -->
                    <!-- <address class="mb-0"> -->
                      <!-- <strong> Delhi </strong><br> -->
                      <!-- Uttar Pradesh <br> -->
                      <!-- India <br> -->
                      <!-- P: (123) 456-7890 -->
                    <!-- </address> -->
                  <!-- </a> </td> -->
              <!-- </tr> -->

			
            </tbody>

          </table>
         
      </article>

    </div> 
      <div class="col-md-8">
        <div class="pt-3">
          <div id="map" class="map mb-3" style='height: 500px;'></div>
          <!-- <pre id="info"></pre> -->
          <!-- <div class="area-box"> -->
            <!-- <p>Click the map to draw a polygon.</p> -->
            <!-- <div id="calculated-area"></div> -->
          <!-- </div> -->

          <table id="yourLabelId" class="table table-bordered">
            <thead>
              <tr>
                <th> Co ordinates</th>
                <th> Locations</th>
              </tr>
            </thead>
            <tbody>

            </tbody>
            <div class="table_details"></div>
        </div>
      </div>
    </div>
    </div>
    <div class="row">
      <div class="col-md-12">

      </div>
    </div>
  </main>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"
    integrity="sha512-894YE6QWD5I59HgZOGReFYm4dnWc1Qt5NtvYSaNcOP+u1T9qYdvdihz0PPSiiqn/+/3e7Jo4EaG7TubfWGUrMQ=="
    crossorigin="anonymous" referrerpolicy="no-referrer"></script>

  <script>
  
  
	$(document).ready(function(){
		showing_addresss()
    })
	

    mapboxgl.accessToken = 'pk.eyJ1IjoicHJhdmVlbmxrdW1hciIsImEiOiJjbDBncnp6MGcwMHBkM29vMjE2YjB5ZXJ2In0.luURpRwktZMoOvxihp_J_A';
    const map = new mapboxgl.Map({
      container: 'map', // container ID
      style: 'mapbox://styles/mapbox/streets-v11', // style URL
      center: [77.75016552885222, 12.96832211908719], // starting position [lng, lat]
      zoom: 7 // starting zoom
    });
    $('#yourLabelId').hide();
    map.addControl(
      new MapboxGeocoder({
        accessToken: mapboxgl.accessToken,
        mapboxgl: mapboxgl
      })
    );
	map.addControl(new mapboxgl.NavigationControl());
    map.on('click', (e) => {
      $('#yourLabelId').show();
      let store = e.lngLat.wrap();
      let locationValues = Object.values(store);
      let marker1 = new mapboxgl.Marker({ "color": "#198754" })
        .setLngLat(locationValues)
        .addTo(map);
      new mapboxgl.Popup()
        .setLngLat(locationValues)
        //.setHTML('you clicked here: <br/>' + locationValues)
        .addTo(map);
      // console.log(locationValues)
	  
	  address = showing_table(store)
	  split_address = address.split(',')
	  store_address(split_address,store)
	  
	  document.querySelector('#yourLabelId tbody').innerHTML += `<tr> 
              <td> ${locationValues} </td>
              <td> ${address} </td> 
          </tr>`
    });

    
  </script>
  <script>
	function showing_table(store){
	  url = "http://api.tiles.mapbox.com/v4/geocode/mapbox.places-v1/" + store.lng + "," + store.lat + ".json?access_token=" + mapboxgl.accessToken
	  var temp = null
      $.ajax({
        url: url,
		async: false,
        type: 'GET',
        dataType: 'json', // added data type
        success: function (res) {
          var address = res['features'][0]['place_name'];
		  temp = address
        }
      });
	  return temp;		
	}
	
	function store_address(address,location){
		url = "api/address-add/"
		value = {
				'address_title': "test",
				'address_type': "current",
				'address_line1':"1st street",
				'address_line2': "west",
				'city':address[0],
				'state':address[1],
				'country': "india",
				'postal_code': "657680",
				'latitude': location.lat,
				'longitude': location.lng
				}
		console.log(value)
		$.ajax({
        url: url,
        type: 'POST',
		data: value,
        dataType: 'json', // added data type
        success: function (res) {
			var response = res['result']
			showing_addresss()
        }
        });
	
	}
	
	function showing_addresss(){
	
		get_url = "api/address-list/?post_code=1"
		$.ajax({
        url: get_url,
        type: 'GET',
        dataType: 'json', // added data type
        success: function (res) {
          var data = res['data'];
		  var html = ''
		  $.each(data, function(i, val){
			if(i%2 == 0){
				colour = "red"
			}else{
				colour = "green"
			}	
		    var city = val['city']
			var state = val['state']
			var country = val['country']
			
			html+='<tr>'
            html+='<td>'
            html+='<i class="fa fa-map-marker fa-2x '+colour+'"> </i>'
            html+='</td>'
            html+='<td>'
            html+='<a href="#" class="map-btn button" data-latLng="77.580643,12.972442">'
            html+='<address class="mb-0">'
            html+='<strong> '+ city +' </strong><br>'+state+' <br>'+country+' <br>'
            html+='</address>'
            html+='</a>'
            html+='</td>'
            html+='</tr>'
			$("#map_details").html(html)  
			
		  })
		 } 
        })
	}
  </script>

</body>

</html>